# 选择列拖拽排序功能使用说明

## 功能概述

在查询数据页面的"选择列"模块中，现在支持通过鼠标拖拽来调整已选中列的显示顺序，从而改变查询结果中列的显示顺序。

## 如何使用

### 1. 选择列

- 首先在"选择列"区域选择您需要的表格
- 从可用列列表中选择需要查询的列
- 选中的列会显示在"已选择的列"区域中

### 2. 拖拽排序

- 当您选择了2列或以上时，会显示拖拽排序提示
- 每个列项左侧都有一个拖拽手柄图标（⋮⋮）
- 将鼠标悬停在拖拽手柄上，光标会变成抓取状态
- 按住鼠标左键并拖拽列项到目标位置
- 在拖拽过程中会显示蓝色的插入位置指示器
- 松开鼠标完成排序

### 3. 视觉反馈

- **拖拽手柄**：鼠标悬停时会高亮显示
- **拖拽状态**：被拖拽的列会显示半透明并略微旋转
- **插入指示器**：蓝色边框指示将要插入的位置
- **成功提示**：排序完成后会显示"列顺序已更新"的Toast通知

## 技术特性

### 响应式支持

- 在移动设备上，拖拽手柄会更大更容易点击
- 列项在小屏幕上有更多的内边距

### 实时更新

- 拖拽排序后，SQL预览会立即更新
- 查询结果也会按照新的列顺序显示

### 用户体验优化

- 智能的插入位置检测
- 平滑的动画过渡效果
- 清晰的视觉反馈

## 注意事项

1. **最少列数**：需要选择至少2列才会显示拖拽功能提示
2. **只拖拽手柄**：只有点击拖拽手柄（⋮⋮）才能触发拖拽，避免误操作
3. **即时生效**：拖拽排序立即生效，无需额外保存操作
4. **SQL同步**：列顺序改变会实时反映在SQL预览中

## 浏览器兼容性

该功能使用HTML5原生拖拽API实现，支持：

- Chrome 4+
- Firefox 3.5+
- Safari 3.1+
- Edge (所有版本)
- Internet Explorer 9+

## 实现原理

### 前端技术

- 使用HTML5 Drag and Drop API
- 原生JavaScript实现，无需额外库依赖
- CSS3过渡动画增强用户体验

### 核心逻辑

1. 为每个列项添加`draggable="true"`属性
2. 监听`dragstart`、`dragover`、`drop`、`dragend`事件
3. 通过`selectedColumns`数组重新排序
4. 实时更新UI和SQL预览

### 样式增强

```css
.grid-column-item {
    cursor: grab;
    position: relative;
}

.grid-column-item.dragging {
    opacity: 0.5;
    cursor: grabbing;
    transform: rotate(2deg);
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}
```

## 扩展建议

未来可以考虑添加的功能：

1. 键盘快捷键支持（上下箭头键排序）
2. 批量拖拽多列
3. 保存常用的列顺序模板
4. 恢复默认顺序功能
